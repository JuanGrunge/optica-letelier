
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Óptica Letelier - Sistema</title>

  <!-- API base (sin prefijo) -->
  <meta name="api-base" content=""/>

  <!-- CSS (rutas RELATIVAS) -->
  <link rel="stylesheet" href="assets/css/core.css">
  <link rel="stylesheet" href="assets/css/layout.css">
  <link rel="stylesheet" href="assets/css/components-header.css">
  <link rel="stylesheet" href="assets/css/components-forms.css">
  <link rel="stylesheet" href="assets/css/components-tables.css">
  <link rel="stylesheet" href="assets/css/components-modal.css">
  <link rel="stylesheet" href="assets/css/utilities.css">
  <link rel="stylesheet" href="assets/css/theme-dark.css">

  <meta name="description" content="Sistema de gestión para Óptica Letelier: ingreso y búsqueda de pacientes, recetas y órdenes.">
  <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico">
</head>
<body class="preboot">
  <!-- Early boot aquí para evitar body null -->
  <script src="assets/js/early-boot.js"></script>

  <header>
    <h2 class="brand"><img src="assets/img/logo.png" alt="logo" class="logo"></h2>

    <nav data-auth="protected">
      <ul>
        <li>
          <button type="button" id="navArchivo" class="nav-pill" aria-label="Archivo">
            <svg viewBox="0 0 24 24" aria-hidden="true" class="nav-ic">
              <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 19a9 9 0 0 1 9 -9h9"/>
                <path d="M3 6h18"/>
                <path d="M3 6v13a2 2 0 0 0 2 2h13"/>
              </g>
            </svg>
            <span class="nav-label">Archivo</span>
          </button>
        </li>
        <li>
          <button type="button" id="navIngresar" class="nav-pill" aria-label="Ingresar paciente">
            <svg viewBox="0 0 24 24" aria-hidden="true" class="nav-ic">
              <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M8 7a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"/>
                <path d="M6 21v-2a4 4 0 0 1 4 -4h4"/>
                <path d="M16 19h6"/>
                <path d="M19 16v6"/>
              </g>
            </svg>
            <span class="nav-label">Ingresar paciente</span>
          </button>
        </li>
      </ul>
    </nav>

    <div class="session-area" data-auth="protected">
      <span id="userBadge" class="user-badge" aria-live="polite" hidden></span>
      <button id="btnLogout" class="btn-logout nav-pill" type="button" hidden aria-label="Cerrar sesión">
        <svg viewBox="0 0 24 24" aria-hidden="true" class="nav-ic">
          <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
            <path d="M7 12h11"/>
            <path d="M10 9l-3 3l3 3"/>
          </g>
        </svg>
        <span class="nav-label">Cerrar sesión</span>
      </button>
    </div>

    <span class="menu-toggle" aria-label="Abrir menú" data-auth="protected">☰</span>

    <div class="theme-switch-wrapper">
      <label class="theme-switch" title="Modo oscuro">
        <input type="checkbox" id="darkModeToggle">
        <span class="slider round"></span>
      </label>
    </div>
  </header>

  <!-- Login -->
  <section id="loginOverlay" class="login-overlay" aria-label="Inicio de sesión">
    <div class="login-card" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
      <h2 id="loginTitle">Iniciar sesión</h2>
      <form id="loginForm">
        <label for="loginUser">Usuario</label>
        <input id="loginUser" autocomplete="username" type="text" placeholder="Ej: admin" required>

        <label for="loginPass">Contraseña</label>
        <input id="loginPass" autocomplete="current-password" type="password" placeholder="••••••••" required>

        <button type="submit" class="login-btn">Entrar</button>
        <p id="loginMsg" class="login-msg" aria-live="polite"></p>

        <details class="hint">
          <summary>¿Primera vez?</summary>
          <small>Admin: <strong>admin</strong> / <strong>letelier25</strong></small>
        </details>
      </form>
    </div>
  </section>

  <!-- Ingresar -->
  <section id="ingresar" class="view" aria-hidden="true">
    <h2>Ingresar Paciente</h2>
    <!-- ... (igual que antes) ... -->
  </section>

  <!-- Archivo -->
  <section id="archivo" class="view" aria-hidden="false">
    <h2>Archivo</h2>
    <p class="subtle">Busca por <strong>RUT, Nombre o Lugar de Operativo</strong> con un solo campo.</p>
    <form id="formBuscar">
      <div class="filters single">
        <div class="search-wrap">
          <input id="fQuery" type="text" placeholder="Ej: 12.345.678-K • Juan • Plaza Central">
          <button class="icon-search-btn" type="submit" aria-label="Buscar" title="Buscar">
            <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
              <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 1 0-.71.71l.27.28v.79L20 21.5 21.5 20l-6-6zM10 15a5 5 0 1 1 0-10 5 5 0 0 1 0 10z" fill="currentColor"/>
            </svg>
          </button>
        </div>
      </div>
    </form>
    <div id="resultados" class="resultados">
      <h3>Resultados</h3>
      <div id="listaResultados" class="lista-resultados"></div>
      <p id="msgResultados" class="subtle"></p>
    </div>
  </section>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- Comportamiento de header (hamburguesa + tema) -->
  <!--script defer src="assets/js/ui/header.behavior.js"></script>

  <!-- JS principal como módulo -->
  <script type="module" src="assets/js/main.js"></script>

  <!-- Repos opcionales que use index -->
  <script defer src="assets/js/infra/config.api.js"></script>
  <script defer src="assets/js/infra/repos/http.patients.repository.js"></script>
</body>
</html>
