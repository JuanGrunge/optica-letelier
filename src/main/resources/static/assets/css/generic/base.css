/* generic/base.css — estilos globales mínimos */

/* Fondo con mosaico temático (debajo de todo el contenido y overlays) */
html, body{ min-height:100%; }
body{
  margin: 0;
  font-family: var(--ff-sans);
  color: var(--color-text);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  position: relative;
  background-color: var(--color-bg);
  background-image: var(--bg-pattern);
  background-repeat: repeat;
  background-size: var(--bg-pattern-size, 256px 256px);
  background-attachment: fixed; /* sensación de lienzo */
  /* Deja espacio al final para que el panel de vidrio no quede oculto
     detrás de la última tarjeta */
  padding-bottom: var(--shell-bottom-pad);
  /* Gutter dinámico que iguala al del panel de vidrio */
  --shell-gutter: var(--shell-side);
  /* El header es fijo; evitamos padding-top para no empujarlo. 
     El overlay (body::before) ya respeta --size-header. */
}

/* Panel de vidrio global detrás del contenido (excepto header) */
body::before{
  content:"";
  position: absolute;
  left: var(--shell-side);
  right: var(--shell-side);
  top: var(--size-header);
  bottom: var(--shell-bottom-pad);
  pointer-events: none;
  background: var(--shell-tint);
  backdrop-filter: blur(var(--shell-blur)) saturate(var(--shell-saturate));
  -webkit-backdrop-filter: blur(var(--shell-blur)) saturate(var(--shell-saturate));
  border: 1px solid rgba(255,255,255,.05);
  box-shadow: 0 8px 24px rgba(0,0,0,.08);
  border-radius: var(--radius-lg);
  z-index: 200; /* por debajo del contenido y del header */
}

/* En estado sin sesión, el contenido principal es fijo (login),
   por lo que el body no crece; fijamos el shell al viewport */
body.no-session::before{
  position: fixed;
  bottom: 0;
}

/* Asegura que contenido principal pinte sobre el shell (excluye header fijo) */
.view, .c-login, main, section, nav { position: relative; z-index: 400; }

@media (max-width: 1200px){ body{ --shell-gutter: 8vw; } body::before{ left:8vw; right:8vw; } }
@media (max-width: 900px){  body{ --shell-gutter: 6vw; } body::before{ left:6vw; right:6vw; } }
@media (max-width: 640px){  body{ --shell-gutter: 3vw; } body::before{ left:3vw; right:3vw; border-radius: var(--radius-md); } }

/* Layout simple para ficha de paciente */
.grid-2{ display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; }
.paciente-detalle{ display: block; margin-top: 12px; }
.paciente-detalle .subseccion{ margin-top: 10px; }
.paciente-detalle ul{ margin: 6px 0 0; padding-left: 18px; }

/* Tiles para listas compactas (recetas, boletas) */
.list-tiles{ list-style: none; padding: 0; margin: 8px 0 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(min(100%, 300px), 1fr)); gap: var(--space-4); }
.list-tiles .tile{
  background: color-mix(in oklab, var(--color-surface) 94%, #000);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: 10px 12px;
  box-shadow: var(--shadow-1);
}
.tile__title{ font-weight: 600; margin-bottom: 6px; display:flex; align-items:center; gap:8px; }
.tile__title--right{ justify-content: flex-end; }
.tile__row{ display: grid; grid-template-columns: 56px 1fr; gap: 8px; align-items: start; margin: 4px 0; }
.tile__label{ font-weight: 600; color: var(--color-text-muted); }
.tile__value{ font-variant-numeric: tabular-nums; font-feature-settings: "tnum" 1; }
.tile__obs{ margin-top: 6px; font-size: .92em; color: var(--color-text-muted); }
.tile__eyes{ display: grid; gap: 8px; margin: 6px 0; }
.tile__eye{ display: grid; grid-template-columns: 56px 1fr; gap: 8px; align-items: start; }
.tile__eye .eye__label{ font-weight: 600; color: var(--color-text-muted); }
.tile__eye .eye__specs{ display: grid; gap: 2px; }
@media (min-width: 480px){
  .list-tiles{ grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
}
@media (min-width: 1024px){
  .list-tiles{ grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
}
.badge{ display:inline-block; padding:2px 6px; border-radius: 10px; font-size: .82em; line-height: 1.4; color: inherit; }
.badge--warn{ background: color-mix(in oklab, var(--color-accent) 22%, #000); color: #fff; }
.badge--pill{ border-radius: 9999px; padding: 2px 10px; font-weight: 600; }
/* Badge por rol */
/* Colores institucionales por rol */
/* ADMIN: rojo carmesí #DC143C */
.badge--role-admin{ background: rgba(220,20,60,.20); border: 1px solid rgba(220,20,60,.35); }
/* RECEPTOR: amarillo rey #FADA5E */
.badge--role-receptor{ background: rgba(250,218,94,.24); border: 1px solid rgba(250,218,94,.38); }
/* OPTICO: azul zafiro #0F52BA */
.badge--role-optico{ background: rgba(15,82,186,.20); border: 1px solid rgba(15,82,186,.35); }

/* Paginación */
.pagination{ display:flex; align-items:center; gap: 10px; margin: 10px 0; }
.pagination .page-info{ color: var(--color-text-muted); }
.pagination button{
  padding: 6px 10px; border-radius: var(--radius-sm);
  background: var(--color-surface);
  color: var(--color-text);
  border: 1px solid var(--color-border);
}
.pagination button:hover{ filter: brightness(1.05); }
.pagination button:disabled{ opacity: .5; cursor: not-allowed; }


/* Indicador de filas clicables */
.c-table tbody tr.row-paciente{ cursor: pointer; }
/* Mejora contraste etiquetas OD/OI/ADD */
/* etiqueta usa el token mutado por tema */
/* (no forzar color aquí para no romper claro/oscuro) */



/* ===== Transiciones base (globales) ===== */
.fade-fast-enter-active, .fade-fast-leave-active { transition: opacity .30s ease; }
.fade-fast-enter-from, .fade-fast-leave-to { opacity: 0; }

.card-fade-enter-active, .card-fade-leave-active { transition: opacity .40s ease, transform .40s ease; }
.card-fade-enter-from, .card-fade-leave-to { opacity: 0; transform: translateY(4px); }

.list-fade-enter-active, .list-fade-leave-active { transition: opacity .50s ease, transform .50s ease; }
.list-fade-enter-from, .list-fade-leave-to { opacity: 0; transform: translateY(3px); }

@media (prefers-reduced-motion: reduce){
  .fade-fast-enter-active, .fade-fast-leave-active,
  .card-fade-enter-active, .card-fade-leave-active,
  .list-fade-enter-active, .list-fade-leave-active{ transition-duration: .001ms !important; }
  .card-fade-enter-from, .card-fade-leave-to,
  .list-fade-enter-from, .list-fade-leave-to{ transform: none !important; }
}

/* ===== Splash / loader mínimo ===== */
.app-splash{
  min-height: calc(100vh - var(--size-header));
  display:flex; align-items:center; justify-content:center;
}
.spinner{
  width: 28px; height: 28px; border-radius: 50%;
  border: 3px solid var(--color-border);
  border-top-color: var(--color-accent);
  animation: spin .9s linear infinite;
  opacity: .9;
}
@keyframes spin{ to { transform: rotate(360deg); } }

/* Evitar zoom al enfocar inputs en móviles (iOS/Chrome iPhone)
   Safari/Chrome fuerzan zoom si la fuente < 16px. Establecemos 16px
   para todos los campos editables, sin afectar sliders/checkbox/radio. */
@media (max-width: 640px){
  input:not([type="range"]):not([type="checkbox"]):not([type="radio"]),
  select,
  textarea{
    font-size: 16px;
  }
}
