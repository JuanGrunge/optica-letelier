<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Óptica Letelier - Sistema</title>
  <meta name="description" content="Sistema de gestión para Óptica Letelier: ingreso y búsqueda de pacientes, recetas y boletas.">
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <header>
    <h2 class="brand"><img src="assets/img/logo.png" alt="logo" class="logo"></h2>
    <nav>
      <ul>
        <li onclick="showSection('ingresar')">Ingresar Paciente</li>
        <li onclick="showSection('archivo')">Archivo</li>
      </ul>
    </nav>
    <span class="menu-toggle" aria-label="Abrir menú">☰</span>
    <div class="theme-switch-wrapper">
      <label class="theme-switch" title="Modo oscuro">
        <input type="checkbox" id="darkModeToggle">
        <span class="slider round"></span>
      </label>
    </div>
  </header>

  <!-- INGRESAR -->
  <section id="ingresar" class="active">
    <h2>Ingresar Paciente</h2>

    <form id="formIngresar" onsubmit="guardarPaciente(event)">
      <label>Nombre Completo</label>
      <input id="nombre" type="text" placeholder="Ej: Juan Pérez" required>

      <label>RUT</label>
      <input id="rut" type="text" placeholder="Ej: 12.345.678-K" required>
      <small id="rutError" class="field-error" aria-live="polite"></small>

      <label>Dirección</label>
      <input id="direccion" type="text" placeholder="Ej: Av. Siempre Viva 742">

      <label>Fecha de Nacimiento</label>
      <input id="fechaNac" type="date">

      <label>Lugar de Operativo</label>
      <input id="operativo" type="text" placeholder="Ej: Operativo Plaza Central, Comuna X" required>

      <h3>Receta Óptica</h3>
      <div class="overflow-x-auto">
        <table class="rx-table">
          <thead>
            <tr>
              <th>Ojo</th>
              <th>Esfera</th>
              <th>Cilindro</th>
              <th>Eje</th>
              <th>ADD</th>
              <th>PD (mm)</th>
              <th>ALT (mm)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="eye-tag">OD</td>
              <td><input id="odEsf" type="number" step="0.25"></td>
              <td><input id="odCil" type="number" step="0.25"></td>
              <td><input id="odEje" type="number" step="1" min="0" max="180"></td>
              <td><input id="odAdd" type="number" step="0.25"></td>
              <td><input id="odPD"  type="number" step="0.5" min="0"></td>
              <td><input id="odALT" type="number" step="0.5" min="0"></td>
            </tr>
            <tr>
              <td class="eye-tag">OI</td>
              <td><input id="oiEsf" type="number" step="0.25"></td>
              <td><input id="oiCil" type="number" step="0.25"></td>
              <td><input id="oiEje" type="number" step="1" min="0" max="180"></td>
              <td><input id="oiAdd" type="number" step="0.25"></td>
              <td><input id="oiPD"  type="number" step="0.5" min="0"></td>
              <td><input id="oiALT" type="number" step="0.5" min="0"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <h4>Diagnóstico</h4>
      <div class="checkbox-grid">
        <label class="check-row"><span class="check-text">Miopía</span><input type="checkbox" name="dx" value="Miopía"></label>
        <label class="check-row"><span class="check-text">Astigmatismo</span><input type="checkbox" name="dx" value="Astigmatismo"></label>
        <label class="check-row"><span class="check-text">Hipermetropía</span><input type="checkbox" name="dx" value="Hipermetropía"></label>
        <label class="check-row"><span class="check-text">Presbicie</span><input type="checkbox" name="dx" value="Presbicie"></label>
      </div>

      <h4>Cristal</h4>
      <div class="checkbox-grid">
        <label class="check-row"><span class="check-text">Antirreflejo</span><input type="checkbox" name="cristal" value="Antirreflejo"></label>
        <label class="check-row"><span class="check-text">Fotocromático</span><input type="checkbox" name="cristal" value="Fotocromático"></label>
        <label class="check-row"><span class="check-text">Bifocal</span><input type="checkbox" name="cristal" value="Bifocal"></label>
        <label class="check-row"><span class="check-text">Multifocal</span><input type="checkbox" name="cristal" value="Multifocal"></label>
        <label class="check-row"><span class="check-text">Filtro Azul</span><input type="checkbox" name="cristal" value="Filtro Azul"></label>
        <label class="check-row"><span class="check-text">Filtro UV</span><input type="checkbox" name="cristal" value="Filtro UV"></label>
        <label class="check-row"><span class="check-text">Lejos</span><input type="checkbox" name="cristal" value="Lejos"></label>
        <label class="check-row"><span class="check-text">Cerca</span><input type="checkbox" name="cristal" value="Cerca"></label>
      </div>

      <label>Observaciones</label>
      <textarea id="obs" rows="3" placeholder="Notas clínicas, indicaciones, etc."></textarea>

      <button id="btnGuardar" type="submit">Guardar</button>
    </form>

    <p id="msgGuardado" class="msg-estado" aria-live="polite"></p>
  </section>

  <!-- ARCHIVO -->
  <section id="archivo">
    <h2>Archivo</h2>
    <p class="subtle">Busca por <strong>RUT, Nombre o Lugar de Operativo</strong> con un solo campo.</p>

    <form id="formBuscar" onsubmit="event.preventDefault(); buscarPacientes();">
      <div class="filters single">
        <div class="search-wrap">
          <input id="fQuery" type="text" placeholder="Ej: 12.345.678-K • Juan • Plaza Central">
          <button class="icon-search-btn" type="submit" aria-label="Buscar">
            <!-- Lupa minimal en SVG -->
            <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
              <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 1 0-.71.71l.27.28v.79L20 21.5 21.5 20l-6-6zM10 15a5 5 0 1 1 0-10 5 5 0 0 1 0 10z" fill="currentColor"/>
            </svg>
          </button>
        </div>
      </div>
    </form>

    <div id="resultados" class="resultados">
      <h3>Resultados</h3>
      <div id="listaResultados" class="lista-resultados"></div>
      <p id="msgResultados" class="subtle"></p>
    </div>
  </section>

  <script src="assets/js/script.js"></script>
</body>
</html>
