<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Óptica Letelier - Sistema</title>
  <meta name="description" content="Sistema de gestión para Óptica Letelier: ingreso y búsqueda de pacientes, recetas y boletas.">
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <header>
    <h2><img src="assets/img/logo.png" alt="logo" class="logo" style="vertical-align: middle;"></h2>
    <nav>
      <ul>
        <li onclick="showSection('ingresar')">Ingresar Paciente</li>
        <li onclick="showSection('archivo')">Archivo</li>
      </ul>
    </nav>
    <span class="menu-toggle">☰</span>
    <div class="theme-switch-wrapper">
      <label class="theme-switch">
        <input type="checkbox" id="darkModeToggle">
        <span class="slider round"></span>
      </label>
    </div>
  </header>

  <!-- INGRESAR -->
  <section id="ingresar" class="active">
    <h2>Ingresar Paciente</h2>

    <form id="formIngresar" onsubmit="guardarPaciente(event)">
      <label>Nombre Completo</label>
      <input id="nombre" type="text" placeholder="Ej: Juan Pérez" required>

      <label>RUT</label>
      <input id="rut" type="text" placeholder="Ej: 12.345.678-9" required>

      <label>Edad</label>
      <input id="edad" type="number" min="0" placeholder="Ej: 35">

      <!-- NUEVO: Lugar de operativo -->
      <label>Lugar de Operativo</label>
      <input id="operativo" type="text" placeholder="Ej: Operativo Plaza Central, Comuna X" required>

      <h3>Receta Óptica</h3>
      <div class="overflow-x-auto">
        <table>
          <thead>
            <tr>
              <th>Ojo</th>
              <th>Esfera</th>
              <th>Cilindro</th>
              <th>Eje</th>
              <th>ADD</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>OD</td>
              <td><input id="odEsf" type="number" step="0.25"></td>
              <td><input id="odCil" type="number" step="0.25"></td>
              <td><input id="odEje" type="number" step="1"></td>
              <td><input id="odAdd" type="number" step="0.25"></td>
            </tr>
            <tr>
              <td>OI</td>
              <td><input id="oiEsf" type="number" step="0.25"></td>
              <td><input id="oiCil" type="number" step="0.25"></td>
              <td><input id="oiEje" type="number" step="1"></td>
              <td><input id="oiAdd" type="number" step="0.25"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <h4>Cristal</h4>
      <div class="checkbox-group">
        <label> Filtro azul <input id="optFiltroAzul" type="checkbox"></label>
        <label> Fotocromáticos <input id="optFotocrom" type="checkbox"></label>
        <label> Bifocales/Multifocales <input id="optMulti" type="checkbox"></label>
      </div>

      <label>Distancia Pupilar (DP mm)</label>
      <input id="dp" type="number" min="0">

      <label>Observaciones</label>
      <textarea id="obs" rows="3" placeholder="Notas clínicas, indicaciones, etc."></textarea>

      <button type="submit">Ingresar Paciente</button>
    </form>

    <p id="msgGuardado" class="msg-estado" aria-live="polite"></p>
  </section>

  <!-- ARCHIVO (MOTOR DE BÚSQUEDA) -->
  <section id="archivo">
    <h2>Archivo</h2>
    <p class="subtle">Motor de búsqueda por RUT, Nombre o Lugar de Operativo.</p>

    <form id="formBuscar" onsubmit="event.preventDefault(); buscarPacientes();">
      <div class="filters">
        <div>
          <label>RUT</label>
          <input id="fRut" type="text" placeholder="Ej: 12.345.678-9">
        </div>
        <div>
          <label>Nombre</label>
          <input id="fNombre" type="text" placeholder="Ej: Juan">
        </div>
        <div>
          <label>Lugar de Operativo</label>
          <input id="fOperativo" type="text" placeholder="Ej: Plaza Central">
        </div>
      </div>
      <div class="actions">
        <button type="submit">Buscar</button>
        <button type="button" class="secondary" onclick="limpiarBusqueda()">Limpiar</button>
      </div>
    </form>

    <div id="resultados" class="resultados">
      <h3>Resultados</h3>
      <div class="overflow-x-auto">
        <table>
          <thead>
            <tr>
              <th>Nombre</th>
              <th>RUT</th>
              <th>Edad</th>
              <th>Operativo</th>
              <th>DP</th>
              <th>Opciones</th>
            </tr>
          </thead>
          <tbody id="tbodyResultados">
            <!-- Se llena dinámicamente -->
          </tbody>
        </table>
      </div>
      <p id="msgResultados" class="subtle"></p>
    </div>
  </section>

  <script src="assets/js/script.js"></script>
</body>
</html>
